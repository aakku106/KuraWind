import{a as g}from"./index-CF7Ri3zE.js";let r={1:[{id:"msg_1_1",senderId:1,senderName:"Aarya Sharma",message:"Hey there! How's your day going?",timestamp:"10:30 AM",isOwn:!1},{id:"msg_1_2",senderId:"current",senderName:"You",message:"Hi Aarya! Pretty good, just working on some projects",timestamp:"10:32 AM",isOwn:!0},{id:"msg_1_3",senderId:1,senderName:"Aarya Sharma",message:"That's awesome! What kind of projects?",timestamp:"10:33 AM",isOwn:!1},{id:"msg_1_4",senderId:"current",senderName:"You",message:"Building a cool messenger app ðŸ˜Š",timestamp:"10:35 AM",isOwn:!0},{id:"msg_1_5",senderId:1,senderName:"Aarya Sharma",message:"Hey! How are you doing?",timestamp:"10:37 AM",isOwn:!1},{id:"msg_1_6",senderId:1,senderName:"Aarya Sharma",message:"Sounds interesting! Can't wait to see it",timestamp:"10:38 AM",isOwn:!1}],2:[{id:"msg_2_1",senderId:2,senderName:"Bikram Thapa",message:"Thanks for helping me yesterday!",timestamp:"Yesterday 3:45 PM",isOwn:!1},{id:"msg_2_2",senderId:"current",senderName:"You",message:"No problem at all! Happy to help",timestamp:"Yesterday 3:47 PM",isOwn:!0},{id:"msg_2_3",senderId:2,senderName:"Bikram Thapa",message:"You're the best! ðŸ™Œ",timestamp:"Yesterday 3:48 PM",isOwn:!1}],3:[{id:"msg_3_1",senderId:"current",senderName:"You",message:"Hey Chandra, what time works for you?",timestamp:"Today 2:30 PM",isOwn:!0},{id:"msg_3_2",senderId:3,senderName:"Chandra Karki",message:"Are we still meeting at 5pm?",timestamp:"Today 2:45 PM",isOwn:!1},{id:"msg_3_3",senderId:"current",senderName:"You",message:"Yes, 5pm works perfect!",timestamp:"Today 2:46 PM",isOwn:!0}],4:[{id:"msg_4_1",senderId:4,senderName:"Deepak Rai",message:"Check out this cool video!",timestamp:"Yesterday",isOwn:!1},{id:"msg_4_2",senderId:4,senderName:"Deepak Rai",message:"https://example.com/video",timestamp:"Yesterday",isOwn:!1}],5:[{id:"msg_5_1",senderId:"current",senderName:"You",message:"Happy birthday Esha! ðŸŽ‚",timestamp:"2 days ago",isOwn:!0},{id:"msg_5_2",senderId:5,senderName:"Esha Gurung",message:"Happy birthday! ðŸŽ‰",timestamp:"2 days ago",isOwn:!1},{id:"msg_5_3",senderId:5,senderName:"Esha Gurung",message:"Thank you so much! â¤ï¸",timestamp:"2 days ago",isOwn:!1}]};const i=()=>{try{const e=localStorage.getItem("kurawind_chat_history");if(e){const s=JSON.parse(e),a={};Object.keys(s).forEach(m=>{a[m]=s[m].map(o=>{let t=o.message;return typeof t=="object"&&t!==null&&(t=t.message||t.content||""),{...o,message:t}})}),r=a,n()}}catch(e){console.error("Error loading chat history:",e),localStorage.removeItem("kurawind_chat_history")}},n=()=>{try{localStorage.setItem("kurawind_chat_history",JSON.stringify(r))}catch(e){console.error("Error saving chat history:",e)}},u=()=>{try{return r={1:[{id:"msg_1_1",senderId:1,senderName:"Aarya Sharma",message:"Hey there! How's your day going?",timestamp:"10:30 AM",isOwn:!1}],2:[{id:"msg_2_1",senderId:2,senderName:"Bikram Thapa",message:"Hey! Ready for a fresh start?",timestamp:"Now",isOwn:!1}],3:[{id:"msg_3_1",senderId:3,senderName:"Chandra Karki",message:"Hello! Let's start chatting",timestamp:"Now",isOwn:!1}],4:[{id:"msg_4_1",senderId:4,senderName:"Deepak Rai",message:"Hi there!",timestamp:"Now",isOwn:!1}],5:[{id:"msg_5_1",senderId:5,senderName:"Esha Gurung",message:"Hey! Nice to meet you",timestamp:"Now",isOwn:!1}]},localStorage.removeItem("kurawind_chat_history"),n(),!0}catch(e){return console.error("Error clearing chat history:",e),!1}},y=(e,s)=>{try{return r[e]=[{id:`msg_${e}_1`,senderId:e,senderName:s,message:"Hey! Let's start a fresh conversation ðŸ˜Š",timestamp:"Now",isOwn:!1}],n(),!0}catch(a){return console.error("Error clearing individual chat history:",a),!1}},c=()=>{try{return Object.keys(r).forEach(e=>{r[e]=r[e].map(s=>{let a=s.message;return typeof a=="object"&&a!==null&&(a=a.message||a.content||"Message corrupted"),{...s,message:a}})}),n(),console.log("Cleaned up corrupted messages"),!0}catch(e){return console.error("Error cleaning messages:",e),!1}};i();const p=e=>r[e]||[],d=()=>`msg_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,h=async(e,s)=>{r[e]||(r[e]=[]);const a={id:d(),senderId:s.senderId||"current",senderName:s.senderName||"You",message:s.message,timestamp:new Date().toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}),isOwn:!0};r[e].push(a),n();try{await g.sendMessage(e,{message:s.message})&&console.log("Message sent via Ably real-time")}catch{console.log("Ably not available or failed, using local storage only")}return a},_=(e,s)=>{r[e]||(r[e]=[]);const a={id:d(),senderId:s.senderId,senderName:s.senderName,message:s.message,timestamp:s.timestamp,isOwn:!1};return r[e].push(a),n(),a};i();typeof window<"u"&&(window.cleanupCorruptedMessages=c);export{h as a,_ as b,u as c,y as d,p as g};
